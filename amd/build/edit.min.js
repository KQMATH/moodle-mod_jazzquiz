define("mod_jazzquiz/edit",["exports","jquery","mod_jazzquiz/selectors"],(function(_exports,_jquery,_selectors){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * @module     mod_jazzquiz
   * @author     Sebastian S. Gundersen <sebastian@sgundersen.com>
   * @copyright  2015 University of Wisconsin - Madison
   * @copyright  2018 NTNU
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */function submitQuestionOrder(order,courseModuleId){_jquery.default.post("edit.php",{id:courseModuleId,action:"order",order:JSON.stringify(order)},(()=>location.reload()))}function getQuestionOrder(){return[...document.querySelectorAll(".questionlist li")].map((question=>question.dataset.questionId))}function offsetQuestion(questionId,offset){let order=getQuestionOrder(),originalIndex=order.indexOf(questionId);if(-1===originalIndex)return order;for(let i=0;i<order.length;i++)if(i+offset===originalIndex){order[originalIndex]=order[i],order[i]=questionId;break}return order}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.initialize=function(courseModuleId){document.addEventListener("click",(event=>{const editQuestionAction=event.target.closest(_selectors.default.edit.editQuestionAction);if(editQuestionAction){let order=[];switch(editQuestionAction.dataset.action){case"up":order=offsetQuestion(editQuestionAction.dataset.questionId,1);break;case"down":order=offsetQuestion(editQuestionAction.dataset.questionId,-1);break;case"delete":{order=getQuestionOrder();const index=order.indexOf(editQuestionAction.dataset.questionId);-1!==index&&order.splice(index,1);break}default:return}submitQuestionOrder(order,courseModuleId)}}));let questionList=document.getElementsByClassName("questionlist")[0];"undefined"!=typeof Sortable&&Sortable.create(questionList,{handle:".dragquestion",onSort:()=>submitQuestionOrder(getQuestionOrder(),courseModuleId)});!function(courseModuleId){document.addEventListener("click",(event=>{if(event.target.closest(_selectors.default.edit.addSelectedQuestions)){event.preventDefault();let questionIds="";for(const checkbox of document.querySelectorAll(_selectors.default.edit.questionCheckedCheckbox))questionIds+=checkbox.getAttribute("name").slice(1)+",";_jquery.default.post("edit.php",{id:courseModuleId,action:"addquestion",questionids:questionIds},(()=>location.reload()))}}))}(courseModuleId)},_jquery=_interopRequireDefault(_jquery),_selectors=_interopRequireDefault(_selectors)}));

//# sourceMappingURL=edit.min.js.map