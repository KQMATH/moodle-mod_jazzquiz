define("mod_jazzquiz/student",["exports","mod_jazzquiz/core","mod_jazzquiz/selectors"],(function(_exports,_core,_selectors){var obj;
/**
   * @module    mod_jazzquiz
   * @author    Sebastian S. Gundersen <sebastian@sgundersen.com>
   * @copyright 2014 University of Wisconsin - Madison
   * @copyright 2018 NTNU
   * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.initialize=function(){new _core.Quiz(Student).poll(2e3)},_selectors=(obj=_selectors)&&obj.__esModule?obj:{default:obj};class Student{constructor(quiz){this.quiz=quiz,this.voteAnswer=void 0,document.addEventListener("submit",(event=>{event.target.closest(_selectors.default.question.form)&&(event.preventDefault(),this.submitAnswer())})),document.addEventListener("click",(event=>{event.target.closest(_selectors.default.quiz.saveVoteButton)&&this.saveVote();const selectVoteButton=event.target.closest(_selectors.default.quiz.selectVoteButton);selectVoteButton&&(this.voteAnswer=selectVoteButton.value)}))}onNotRunning(){(0,_core.setText)(document.querySelector(_selectors.default.quiz.info),"instructions_for_student")}onPreparing(){(0,_core.setText)(document.querySelector(_selectors.default.quiz.info),"wait_for_instructor")}onRunning(data){if(this.quiz.question.isRunning)return;this.quiz.question.startCountdown(data.questiontime,data.delay)||(0,_core.setText)(document.querySelector(_selectors.default.quiz.info),"wait_for_instructor")}onReviewing(){this.quiz.question.isVoteRunning=!1,this.quiz.question.isRunning=!1,this.quiz.question.hideTimer(),document.querySelector(_selectors.default.question.box).classList.add("hidden"),(0,_core.setText)(document.querySelector(_selectors.default.quiz.info),"wait_for_instructor")}onSessionClosed(){window.location=location.href.split("&")[0]}onVoting(data){if(this.quiz.question.isVoteRunning)return;const quizInfo=document.querySelector(_selectors.default.quiz.info);quizInfo.innerHTML=data.html,quizInfo.classList.remove("hidden");const options=data.options;for(let i=0;i<options.length;i++)_core.Quiz.addMathjaxElement(document.getElementById(options[i].content_id),options[i].text),"stack"===options[i].question_type&&_core.Quiz.renderMaximaEquation(options[i].text,options[i].content_id);this.quiz.question.isVoteRunning=!0}onTimerTick(timeLeft){(0,_core.setText)(document.querySelector(_selectors.default.question.timer),"question_will_end_in_x_seconds","jazzquiz",timeLeft)}submitAnswer(){if(this.quiz.question.isSaving)return;this.quiz.question.isSaving=!0,"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave();const serialized=document.querySelector(_selectors.default.question.form).serializeArray();let data={};for(let name in serialized)serialized.hasOwnProperty(name)&&(data[serialized[name].name]=serialized[name].value);_core.Ajax.post("save_question",data,(data=>{const quizInfo=document.querySelector(_selectors.default.quiz.info);data.feedback.length>0?(quizInfo.innerHTML=data.feedback,quizInfo.classList.remove("hidden")):(0,_core.setText)(quizInfo,"wait_for_instructor"),this.quiz.question.isSaving=!1,this.quiz.question.isRunning&&(this.quiz.question.isVoteRunning||(document.querySelector(_selectors.default.question.box).classList.add("hidden"),this.quiz.question.hideTimer()))})).fail((()=>{this.quiz.question.isSaving=!1}))}saveVote(){_core.Ajax.post("save_vote",{vote:this.voteAnswer},(data=>{const quizInfo=document.querySelector(_selectors.default.quiz.info);"success"===data.status?(0,_core.setText)(quizInfo,"wait_for_instructor"):(0,_core.setText)(quizInfo,"you_already_voted")}))}}}));

//# sourceMappingURL=student.min.js.map