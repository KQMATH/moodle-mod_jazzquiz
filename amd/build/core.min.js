define("mod_jazzquiz/core",["exports","jquery","core/str","core_filters/events","mod_jazzquiz/selectors","mod_jazzquiz/question"],(function(_exports,_jquery,_str,_events,_selectors,_question){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * @module    mod_jazzquiz
   * @author    Sebastian S. Gundersen <sebastian@sgundersen.com>
   * @copyright 2014 University of Wisconsin - Madison
   * @copyright 2018 NTNU
   * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.Quiz=_exports.Ajax=void 0,_exports.initialize=function(courseModuleId,activityId,sessionId,attemptId,sessionKey){session.courseModuleId=courseModuleId,session.activityId=activityId,session.sessionId=sessionId,session.attemptId=attemptId,session.sessionKey=sessionKey},_exports.setText=setText,_jquery=_interopRequireDefault(_jquery),_selectors=_interopRequireDefault(_selectors);let session={courseModuleId:0,activityId:0,sessionId:0,attemptId:0,sessionKey:""},cache=[];class Ajax{static request(method,url,data,success){return data.id=session.courseModuleId,data.sessionid=session.sessionId,data.attemptid=session.attemptId,data.sesskey=session.sessionKey,_jquery.default.ajax({type:method,url:url,data:data,dataType:"json",success:success}).fail((()=>setText(Quiz.info,"error_with_request")))}static get(action,data,success){return data.action=action,Ajax.request("get","ajax.php",data,success)}static post(action,data,success){return data.action=action,Ajax.request("post","ajax.php",data,success)}}_exports.Ajax=Ajax;class Quiz{constructor(Role){this.state="",this.isNewState=!1,this.question=new _question.Question(this),this.role=new Role(this),this.events={notrunning:"onNotRunning",preparing:"onPreparing",running:"onRunning",reviewing:"onReviewing",sessionclosed:"onSessionClosed",voting:"onVoting"}}changeQuizState(state,data){this.isNewState=this.state!==state,this.state=state,void 0!==this.role.onStateChange&&this.role.onStateChange();const event=this.events[state];this.role[event](data)}poll(ms){Ajax.get("info",{},(data=>{this.changeQuizState(data.status,data),setTimeout((()=>this.poll(ms)),ms)}))}static get main(){return(0,_jquery.default)(_selectors.default.main)}static get info(){return(0,_jquery.default)(_selectors.default.quiz.info)}static get responded(){return(0,_jquery.default)(_selectors.default.quiz.responded)}static get responses(){return(0,_jquery.default)(_selectors.default.quiz.responses)}static get responseInfo(){return(0,_jquery.default)(_selectors.default.quiz.responseInfo)}static hide($element){$element.addClass("hidden")}static show($element){$element.removeClass("hidden")}static uncheck($element){$element.children(".fa").removeClass("fa-check-square-o").addClass("fa-square-o")}static check($element){$element.children(".fa").removeClass("fa-square-o").addClass("fa-check-square-o")}static renderAllMathjax(){(0,_events.notifyFilterContentUpdated)(document.getElementsByClassName("jazzquiz-response-container"))}static addMathjaxElement($target,latex){$target.html('<span class="filter_mathjaxloader_equation">'+latex+"</span>"),Quiz.renderAllMathjax()}static renderMaximaEquation(input,targetId){null!==document.getElementById(targetId)&&(void 0===cache[input]?Ajax.get("stack",{input:encodeURIComponent(input)},(data=>{cache[data.original]=data.latex,Quiz.addMathjaxElement((0,_jquery.default)("#"+targetId),data.latex)})):Quiz.addMathjaxElement((0,_jquery.default)("#"+targetId),cache[input]))}}function setText($element,key,from,args){from=void 0!==from?from:"jazzquiz",args=void 0!==args?args:[],_jquery.default.when((0,_str.get_string)(key,from,args)).done((text=>Quiz.show($element.html(text))))}_exports.Quiz=Quiz}));

//# sourceMappingURL=core.min.js.map